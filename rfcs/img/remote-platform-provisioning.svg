<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1280px" preserveAspectRatio="none" style="width:636px;height:1280px;background:#FFFFFF;" version="1.1" viewBox="0 0 636 1280" width="636px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="757.9219" style="stroke:#181818;stroke-width:1.0;" width="10" x="144" y="46.2969"/><rect fill="#FFFFFF" height="421.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="292" y="804.2188"/><rect fill="#FFFFFF" height="1217.7813" style="stroke:#181818;stroke-width:1.0;" width="10" x="488" y="46.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="149" x2="149" y1="36.2969" y2="1273.0781"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="296.5" x2="296.5" y1="36.2969" y2="1273.0781"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="492.5" x2="492.5" y1="36.2969" y2="1273.0781"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="114" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="121" y="24.9951">Platform</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111" x="241.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="248.5" y="24.9951">Fobnail Token</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119" x="433.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="440.5" y="24.9951">Platform Owner</text><rect fill="#FFFFFF" height="757.9219" style="stroke:#181818;stroke-width:1.0;" width="10" x="144" y="46.2969"/><rect fill="#FFFFFF" height="421.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="292" y="804.2188"/><rect fill="#FFFFFF" height="1217.7813" style="stroke:#181818;stroke-width:1.0;" width="10" x="488" y="46.2969"/><polygon fill="#181818" points="476,81.5625,486,85.5625,476,89.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="154" x2="482" y1="85.5625" y2="85.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="161" y="62.3638">Send EK certificate chain</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="161" y="77.4966">EK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="25" x="177" y="81.2041">chain</text><line style="stroke:#181818;stroke-width:1.0;" x1="498" x2="540" y1="117.6953" y2="117.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="540" x2="540" y1="117.6953" y2="130.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="499" x2="540" y1="130.6953" y2="130.6953"/><polygon fill="#181818" points="509,126.6953,499,130.6953,509,134.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="505" y="109.6294">Verify EK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="25" x="561" y="113.3369">chain</text><polygon fill="#181818" points="165,158.8281,155,162.8281,165,166.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159" x2="487" y1="162.8281" y2="162.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="171" y="154.7622">EK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="11" x="187" y="158.4697">ID</text><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="154" y1="194.9609" y2="194.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="112" y1="194.9609" y2="207.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="153" y1="207.9609" y2="207.9609"/><polygon fill="#181818" points="145,203.9609,155,207.9609,145,211.9609" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="29" y="186.895">Generate AIK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="41" x="113" y="190.6025">Priv,Pub</text><polygon fill="#181818" points="476,236.0938,486,240.0938,476,244.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="154" x2="482" y1="240.0938" y2="240.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="161" y="232.0278">EK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="11" x="177" y="235.7354">ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="188" y="232.0278">, AIK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="19" x="216" y="235.7354">Pub</text><line style="stroke:#181818;stroke-width:1.0;" x1="498" x2="540" y1="269.2266" y2="269.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="540" x2="540" y1="269.2266" y2="282.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="499" x2="540" y1="282.2266" y2="282.2266"/><polygon fill="#181818" points="509,278.2266,499,282.2266,509,286.2266" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="505" y="264.1606">Make Credential</text><polygon fill="#181818" points="165,325.4922,155,329.4922,165,333.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159" x2="487" y1="329.4922" y2="329.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="171" y="306.2935">AIK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="11" x="191" y="310.001">ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="202" y="306.2935">,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="171" y="324.4263">Challenge (EK, AIK, secret)</text><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="154" y1="358.625" y2="358.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="112" y1="358.625" y2="371.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="153" y1="371.625" y2="371.625"/><polygon fill="#181818" points="145,367.625,155,371.625,145,375.625" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="33" y="353.5591">Activate Credential</text><polygon fill="#181818" points="476,399.7578,486,403.7578,476,407.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="154" x2="482" y1="403.7578" y2="403.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="161" y="395.6919">EK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="11" x="177" y="399.3994">ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="188" y="395.6919">, AIK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="11" x="216" y="399.3994">ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="227" y="395.6919">, secret</text><line style="stroke:#181818;stroke-width:1.0;" x1="498" x2="540" y1="432.8906" y2="432.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="540" x2="540" y1="432.8906" y2="445.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="499" x2="540" y1="445.8906" y2="445.8906"/><polygon fill="#181818" points="509,441.8906,499,445.8906,509,449.8906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="505" y="427.8247">Mark AIK as trusted</text><polygon fill="#181818" points="165,474.0234,155,478.0234,165,482.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159" x2="487" y1="478.0234" y2="478.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="17" x="171" y="469.9575">PC</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="11" x="188" y="473.665">ID</text><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="154" y1="510.1563" y2="510.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="112" y1="510.1563" y2="523.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="153" y1="523.1563" y2="523.1563"/><polygon fill="#181818" points="145,519.1563,155,523.1563,145,527.1563" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="73" y="502.0903">Obtain A</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="26" x="128" y="505.7979">meta</text><polygon fill="#181818" points="285,551.2891,295,555.2891,285,559.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="154" x2="291" y1="555.2891" y2="555.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="161" y="547.2231">AIK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="18" x="181" y="550.9307">priv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="199" y="547.2231">(A</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="26" x="213" y="550.9307">meta</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="239" y="547.2231">), PC</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="11" x="269" y="550.9307">ID</text><line style="stroke:#181818;stroke-width:1.0;" x1="498" x2="540" y1="587.4219" y2="587.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="540" x2="540" y1="587.4219" y2="600.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="499" x2="540" y1="600.4219" y2="600.4219"/><polygon fill="#181818" points="509,596.4219,499,600.4219,509,604.4219" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="505" y="579.356">Verify A</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="26" x="554" y="583.0635">meta</text><polygon fill="#181818" points="165,625.5547,155,629.5547,165,633.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159" x2="487" y1="629.5547" y2="629.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="171" y="624.4888">Status</text><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="154" y1="658.6875" y2="658.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="112" y1="658.6875" y2="671.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="112" x2="153" y1="671.6875" y2="671.6875"/><polygon fill="#181818" points="145,667.6875,155,671.6875,145,675.6875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="86" y="653.6216">Obtain RIM</text><polygon fill="#181818" points="476,699.8203,486,703.8203,476,707.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="154" x2="482" y1="703.8203" y2="703.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="161" y="695.7544">AIK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="18" x="181" y="699.4619">priv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="199" y="695.7544">(RIM), PC</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="11" x="256" y="699.4619">ID</text><line style="stroke:#181818;stroke-width:1.0;" x1="498" x2="540" y1="732.9531" y2="732.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="540" x2="540" y1="732.9531" y2="745.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="499" x2="540" y1="745.9531" y2="745.9531"/><polygon fill="#181818" points="509,741.9531,499,745.9531,509,749.9531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="505" y="727.8872">Verify RIM</text><polygon fill="#181818" points="165,771.0859,155,775.0859,165,779.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159" x2="487" y1="775.0859" y2="775.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="171" y="770.02">Status</text><polygon fill="#181818" points="476,800.2188,486,804.2188,476,808.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="149" x2="482" y1="804.2188" y2="804.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="156" y="799.1528">Finish provisioning</text><polygon fill="#181818" points="313,832.3516,303,836.3516,313,840.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="487" y1="836.3516" y2="836.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="319" y="828.2856">PO</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="25" x="337" y="831.9932">chain</text><line style="stroke:#181818;stroke-width:1.0;" x1="302" x2="344" y1="868.4844" y2="868.4844"/><line style="stroke:#181818;stroke-width:1.0;" x1="344" x2="344" y1="868.4844" y2="881.4844"/><line style="stroke:#181818;stroke-width:1.0;" x1="303" x2="344" y1="881.4844" y2="881.4844"/><polygon fill="#181818" points="313,877.4844,303,881.4844,313,885.4844" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="309" y="860.4185">Verify PO</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="25" x="367" y="864.126">chain</text><polygon fill="#181818" points="476,909.6172,486,913.6172,476,917.6172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="302" x2="482" y1="913.6172" y2="913.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="17" x="309" y="905.5513">PC</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="11" x="326" y="909.2588">ID</text><polygon fill="#181818" points="313,941.75,303,945.75,313,949.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="487" y1="945.75" y2="945.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="319" y="937.6841">PO</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="18" x="337" y="941.3916">priv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="355" y="937.6841">(A</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="26" x="369" y="941.3916">meta</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="395" y="937.6841">)</text><polygon fill="#181818" points="476,970.8828,486,974.8828,476,978.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="302" x2="482" y1="974.8828" y2="974.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="309" y="969.8169">Status</text><polygon fill="#181818" points="313,1003.0156,303,1007.0156,313,1011.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="487" y1="1007.0156" y2="1007.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="319" y="998.9497">PO</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="18" x="337" y="1002.6572">priv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="355" y="998.9497">(RIM)</text><polygon fill="#181818" points="476,1032.1484,486,1036.1484,476,1040.1484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="302" x2="482" y1="1036.1484" y2="1036.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="309" y="1031.0825">Status</text><polygon fill="#181818" points="313,1064.2813,303,1068.2813,313,1072.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="487" y1="1068.2813" y2="1068.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="319" y="1060.2153">PO</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="18" x="337" y="1063.9229">priv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="355" y="1060.2153">(Policy)</text><polygon fill="#181818" points="313,1093.4141,303,1097.4141,313,1101.4141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307" x2="487" y1="1097.4141" y2="1097.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="319" y="1092.3481">Finish provisioning</text><line style="stroke:#181818;stroke-width:1.0;" x1="302" x2="344" y1="1141.6797" y2="1141.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="344" x2="344" y1="1141.6797" y2="1154.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="303" x2="344" y1="1154.6797" y2="1154.6797"/><polygon fill="#181818" points="313,1150.6797,303,1154.6797,313,1158.6797" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="309" y="1121.481">Verify all data attached</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="309" y="1136.6138">to the Provisioning Context</text><line style="stroke:#181818;stroke-width:1.0;" x1="302" x2="344" y1="1183.8125" y2="1183.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="344" x2="344" y1="1183.8125" y2="1196.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="303" x2="344" y1="1196.8125" y2="1196.8125"/><polygon fill="#181818" points="313,1192.8125,303,1196.8125,313,1200.8125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="309" y="1178.7466">Save data to Flash</text><polygon fill="#181818" points="476,1221.9453,486,1225.9453,476,1229.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="297" x2="482" y1="1225.9453" y2="1225.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="304" y="1220.8794">Status</text><polygon fill="#181818" points="160,1251.0781,150,1255.0781,160,1259.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="154" x2="487" y1="1255.0781" y2="1255.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="166" y="1250.0122">Send provisioning status</text><!--MD5=[af891fa5120f606f818d6ba739e0437c]
@startuml Fobnail Local Platform Provisioning

skinparam style strictuml
participant "Platform"
participant "Fobnail Token" as FT
participant "Platform Owner" as PO

activate Platform
activate PO

Platform -> PO: Send EK certificate chain\nEK<sub>chain</sub>
PO -> PO: Verify EK<sub>chain</sub>
PO - -> Platform: EK<sub>ID</sub>
Platform <- Platform: Generate AIK<sub>Priv,Pub</sub>
Platform -> PO: EK<sub>ID</sub>, AIK<sub>Pub</sub>
PO -> PO: Make Credential
PO - -> Platform: AIK<sub>ID</sub>,\nChallenge (EK, AIK, secret)
Platform <- Platform: Activate Credential
Platform -> PO: EK<sub>ID</sub>, AIK<sub>ID</sub>, secret
PO -> PO: Mark AIK as trusted
PO - -> Platform: PC<sub>ID</sub>
Platform <- Platform: Obtain A<sub>meta</sub>
Platform -> FT: AIK<sub>priv</sub>(A<sub>meta</sub>), PC<sub>ID</sub>
PO -> PO: Verify A<sub>meta</sub>
PO - -> Platform: Status
Platform <- Platform: Obtain RIM
Platform -> PO: AIK<sub>priv</sub>(RIM), PC<sub>ID</sub>
PO -> PO: Verify RIM
PO - -> Platform: Status
Platform -> PO: Finish provisioning

deactivate Platform
activate FT

PO -> FT: PO<sub>chain</sub>
FT -> FT: Verify PO<sub>chain</sub>
FT - -> PO: PC<sub>ID</sub>
PO -> FT: PO<sub>priv</sub>(A<sub>meta</sub>)
FT - -> PO: Status
PO -> FT: PO<sub>priv</sub>(RIM)
FT - -> PO: Status
PO -> FT: PO<sub>priv</sub>(Policy)
PO -> FT: Finish provisioning
FT -> FT: Verify all data attached\nto the Provisioning Context
FT -> FT: Save data to Flash
FT - -> PO: Status

deactivate FT

PO - -> Platform: Send provisioning status

@enduml

PlantUML version 1.2022.7beta3(Unknown compile time)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>

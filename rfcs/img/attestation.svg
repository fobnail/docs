<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="602px" preserveAspectRatio="none" style="width:624px;height:602px;background:#FFFFFF;" version="1.1" viewBox="0 0 624 602" width="624px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="433.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="190" y="152.4844"/><rect fill="#FFFFFF" height="433.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="391" y="152.4844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="195" x2="195" y1="142.4844" y2="595.2109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="395.5" x2="395.5" y1="142.4844" y2="595.2109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="558.5" x2="558.5" y1="142.4844" y2="595.2109"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="160" y="111.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="167" y="131.1826">Platform</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111" x="340.5" y="111.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="347.5" y="131.1826">Fobnail Token</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119" x="499.5" y="111.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="506.5" y="131.1826">Platform Owner</text><rect fill="#FFFFFF" height="433.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="190" y="152.4844"/><rect fill="#FFFFFF" height="433.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="391" y="152.4844"/><polygon fill="#181818" points="379,187.75,389,191.75,379,195.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="200" x2="385" y1="191.75" y2="191.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="207" y="168.5513">Send platform metadata</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="207" y="183.6841">AIK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="18" x="227" y="187.3916">priv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="245" y="183.6841">(A</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="26" x="259" y="187.3916">meta</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="285" y="183.6841">)</text><line style="stroke:#181818;stroke-width:1.0;" x1="401" x2="443" y1="223.8828" y2="223.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="443" y1="223.8828" y2="236.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="402" x2="443" y1="236.8828" y2="236.8828"/><polygon fill="#181818" points="412,232.8828,402,236.8828,412,240.8828" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="408" y="215.8169">Verify A</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="26" x="457" y="219.5244">meta</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="487" y="215.8169">hash</text><line style="stroke:#181818;stroke-width:1.0;" x1="401" x2="443" y1="269.0156" y2="269.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="443" x2="443" y1="269.0156" y2="282.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="402" x2="443" y1="282.0156" y2="282.0156"/><polygon fill="#181818" points="412,278.0156,402,282.0156,412,286.0156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="408" y="260.9497">Verify A</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="26" x="457" y="264.6572">meta</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="487" y="260.9497">signature</text><polygon fill="#181818" points="211,310.1484,201,314.1484,211,318.1484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="205" x2="390" y1="314.1484" y2="314.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="217" y="306.0825">AC</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="8" x="235" y="309.79">id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="243" y="306.0825">, nonce, PCR selection</text><line style="stroke:#181818;stroke-width:1.0;" x1="158" x2="200" y1="346.2813" y2="346.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="158" x2="158" y1="346.2813" y2="359.2813"/><line style="stroke:#181818;stroke-width:1.0;" x1="158" x2="199" y1="359.2813" y2="359.2813"/><polygon fill="#181818" points="191,355.2813,201,359.2813,191,363.2813" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="29" y="338.2153">TPM</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="28" x="55" y="341.9229">quote</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="83" y="338.2153">(AIK, PCRs, nonce)</text><polygon fill="#181818" points="379,387.4141,389,391.4141,379,395.4141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="200" x2="385" y1="391.4141" y2="391.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="207" y="383.3481">AC</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="8" x="225" y="387.0557">id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="233" y="383.3481">, AIK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="18" x="261" y="387.0557">priv</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="279" y="383.3481">(Evidence)</text><line style="stroke:#181818;stroke-width:1.0;" x1="359" x2="401" y1="420.5469" y2="420.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="359" x2="359" y1="420.5469" y2="433.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="359" x2="400" y1="433.5469" y2="433.5469"/><polygon fill="#181818" points="392,429.5469,402,433.5469,392,437.5469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="304" y="415.481">Verify Evidence</text><line style="stroke:#181818;stroke-width:1.0;" x1="359" x2="401" y1="477.8125" y2="477.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="359" x2="359" y1="477.8125" y2="490.8125"/><line style="stroke:#181818;stroke-width:1.0;" x1="359" x2="400" y1="490.8125" y2="490.8125"/><polygon fill="#181818" points="392,486.8125,402,490.8125,392,494.8125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="255" y="457.6138">Evidence Appraisal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="255" y="472.7466">(Nonce, Evidence, RIM)</text><line style="stroke:#181818;stroke-width:1.0;" x1="359" x2="401" y1="535.0781" y2="535.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="359" x2="359" y1="535.0781" y2="548.0781"/><line style="stroke:#181818;stroke-width:1.0;" x1="359" x2="400" y1="548.0781" y2="548.0781"/><polygon fill="#181818" points="392,544.0781,402,548.0781,392,552.0781" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="256" y="514.8794">Unlock access to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="256" y="530.0122">Fobnail Token Services</text><polygon fill="#181818" points="211,573.2109,201,577.2109,211,581.2109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="205" x2="390" y1="577.2109" y2="577.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="217" y="572.145">Trust decision</text><rect fill="#FFFFFF" height="89.1875" id="_legend" rx="7.5" ry="7.5" style="stroke:#FFFFFF;stroke-width:0.0;" width="431" x="8" y="13"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="14" y="31.9951">K</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="23" y="35.7026">priv</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="44" y="31.9951">(X) - Sign X with P</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="164" y="35.7026">priv</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="189" y="31.9951">key</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="14" y="51.292">AIK</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="46" x="35" y="54.9995">priv,pub</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="85" y="51.292">- Attestation Identity key</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="14" y="70.5889">A</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="29" x="23" y="74.2964">meta</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="377" x="56" y="70.5889">Platform metadata (product name, serial number, MAC)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19" x="14" y="89.8857">AC</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="11" x="33" y="93.5933">ID</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="48" y="89.8857">- Attestation Context ID</text><!--MD5=[50967ff3c15404f623c3b9bc50229dba]
@startuml Fobnail Attestation

skinparam LegendBorderThickness 0
skinparam LegendBackgroundColor #white
skinparam style strictuml
participant "Platform"
participant "Fobnail Token" as FT
participant "Platform Owner" as PO

legend top left
    K<sub>priv</sub>(X) - Sign X with P<sub>priv</sub> key
    AIK<sub>priv,pub</sub> - Attestation Identity key
    A<sub>meta</sub> Platform metadata (product name, serial number, MAC)
    AC<sub>ID</sub> - Attestation Context ID
endlegend

activate FT
activate Platform

Platform -> FT: Send platform metadata\nAIK<sub>priv</sub>(A<sub>meta</sub>)
FT -> FT: Verify A<sub>meta</sub> hash
FT -> FT: Verify A<sub>meta</sub> signature
FT -> Platform: AC<sub>id</sub>, nonce, PCR selection
Platform <- Platform: TPM<sub>quote</sub>(AIK, PCRs, nonce)
Platform -> FT: AC<sub>id</sub>, AIK<sub>priv</sub>(Evidence)
FT <- FT: Verify Evidence
FT <- FT: Evidence Appraisal\n(Nonce, Evidence, RIM)
FT <- FT: Unlock access to\nFobnail Token Services
FT - -> Platform: Trust decision

@enduml

PlantUML version 1.2022.7beta3(Unknown compile time)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://fobnail.3mdeb.com/building/">
      
      
        <link rel="prev" href="../fobnail-sdk/">
      
      
        <link rel="next" href="../flashing_preparation/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.5">
    
    
      
        <title>Cloning and building - Fobnail Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6a10b989.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cloning-and-building" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Fobnail Documentation" class="md-header__button md-logo" aria-label="Fobnail Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Fobnail Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cloning and building
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Fobnail Documentation" class="md-nav__button md-logo" aria-label="Fobnail Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Fobnail Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Supported Hardware
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Supported Hardware
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../fobnail_token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fobnail Token
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development Process
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Development Process
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../fobnail-sdk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fobnail SDK
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Cloning and building
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Cloning and building
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fobnail-token-firmware" class="md-nav__link">
    Fobnail Token firmware
  </a>
  
    <nav class="md-nav" aria-label="Fobnail Token firmware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-variables-common-for-both-targets" class="md-nav__link">
    Environment variables common for both targets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-and-running-firmware" class="md-nav__link">
    Building and running firmware
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pc-applications" class="md-nav__link">
    PC applications
  </a>
  
    <nav class="md-nav" aria-label="PC applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#platform-owner" class="md-nav__link">
    Platform Owner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attester" class="md-nav__link">
    Attester
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-and-next-steps" class="md-nav__link">
    Summary and next steps
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../flashing_preparation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flashing preparation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../networking_setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Networking setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../token_provisioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Token provisioning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tpm-simulators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using TPM simulators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../debugging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugging
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Example Applications
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Example Applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../examples/disk_encryption/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disk encryption
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Knowledge Base
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Knowledge Base
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../description/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Detailed description
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../keys_and_certificates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keys and certificates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../fobnail-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fobnail API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../blink-codes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fobnail blink codes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ek_certificates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EK certificate chain sizes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Ethernet over USB
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Ethernet over USB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../eth-over-usb-research/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Research
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../implementing-eth-over-usb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Minimal OSes used with Fobnail Token
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            Minimal OSes used with Fobnail Token
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../minimal-os-for-fobnail/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Research
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../meta-fobnail-in-dlme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    meta-fobnail PoC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../zephyr-in-dlme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zephyr PoC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../xen-in-dlme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xen PoC
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archived
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Archived
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/local_development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developing firmware on PC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/charra-concept-on-pc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run CHARRA concept on PC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/preparation_for_tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preparation for tests
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fobnail-token-firmware" class="md-nav__link">
    Fobnail Token firmware
  </a>
  
    <nav class="md-nav" aria-label="Fobnail Token firmware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-variables-common-for-both-targets" class="md-nav__link">
    Environment variables common for both targets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-and-running-firmware" class="md-nav__link">
    Building and running firmware
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pc-applications" class="md-nav__link">
    PC applications
  </a>
  
    <nav class="md-nav" aria-label="PC applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#platform-owner" class="md-nav__link">
    Platform Owner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attester" class="md-nav__link">
    Attester
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-and-next-steps" class="md-nav__link">
    Summary and next steps
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="cloning-and-building">Cloning and building</h1>
<p>Fobnail project consists of 3 main repositories with code:</p>
<ul>
<li><a href="https://github.com/fobnail/fobnail">Fobnail firmware</a> (Rust)</li>
<li><a href="https://github.com/fobnail/fobnail-platform-owner">Platform Owner</a> (C)</li>
<li><a href="https://github.com/fobnail/fobnail-attester">Attester</a> (C)</li>
</ul>
<p>There is also <a href="https://github.com/fobnail/fobnail-sdk">Fobnail SDK</a> that
simplifies building of firmware by using Docker container, but only
<a href="https://github.com/fobnail/fobnail-sdk/blob/main/run-fobnail-sdk.sh">one script</a>
from this repository is actually needed.</p>
<p>Following steps were successfully performed on Ubuntu 22.04.1 LTS.</p>
<h2 id="fobnail-token-firmware">Fobnail Token firmware</h2>
<p>Start by installing prerequisites:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>git
</code></pre></div>
<p>Log out of the desktop session then log in again - this is required after making
the change to user groups. You may confirm it by running <code>groups</code>.</p>
<p>Clone the repository along with its submodules:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/fobnail/fobnail<span class="w"> </span>--recurse-submodules
</code></pre></div>
<p>Build process for Token firmware is by far the most complicated one. For that
reason use of Fobnail SDK is strongly suggested. Follow <a href="/fobnail-sdk">these
instructions</a> to install it.</p>
<p>With the SDK installed, one can prepare for the build process itself. Firmware
can be build for a physical Fobnail Token or simulated on PC, with different
preparatory steps required.</p>
<p>If TPM simulator is to be used, steps from <a href="/tpm-simulators">this document</a> must
be done before Token firmware is compiled. Instructions from the linked document
result in creation of root CA certificate for EK chain, that certificate must be
supplied as an input to Token build command. Physical TPMs require certificate
provided by TPM vendor instead, those are included in <code>fobnail</code> repository.</p>
<h4 id="environment-variables-common-for-both-targets">Environment variables common for both targets</h4>
<p>Fobnail Token firmware is configured with environment variables passed to
<code>build.sh</code>.</p>
<p>Note that due to the way Docker mounts directories all files and directories
pointed to by following variables must be located somewhere in <code>fobnail</code>
directory.</p>
<ul>
<li>
<p><code>FOBNAIL_PO_ROOT</code> - <strong>required</strong> option, must point to valid PEM or DER file
  with Platform Owner's root certificate. See <a href="/keys_and_certificates/#platform-owner-certificate-chain">this document</a>
  for description of PO certificate chain and instructions for building such.
  For Fobnail Token firmware it is enough to create only <a href="/keys_and_certificates/#root-ca">root CA certificate</a>.
  The rest of chain will be required for provisioning.</p>
</li>
<li>
<p><code>FOBNAIL_EK_ROOT_DIR</code> - points to directory with TPM root certificates.
  Fobnail repository includes <a href="https://github.com/fobnail/fobnail/tree/main/tpm_ek_roots">such directory</a>
  which normally should be used as <code>FOBNAIL_EK_ROOT_DIR</code>, but you may change it
  if certificates supplied in repository became outdated. Either this or
  <code>FOBNAIL_EXTRA_EK_ROOT</code> (or both) <strong>must be specified</strong>.</p>
</li>
<li>
<p><code>FOBNAIL_EXTRA_EK_ROOT</code> - points to one specific TPM certificate. Useful when
  <a href="/tpm-simulators/">testing with TPM emulator</a>, or to limit Fobnail usage to
  one specific TPM vendor. Either this or <code>FOBNAIL_EK_ROOT_DIR</code> (or both)
  <strong>must be specified</strong>.</p>
</li>
</ul>
<h4 id="building-and-running-firmware">Building and running firmware</h4>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Physical Fobnail Token</label><label for="__tabbed_1_2">PC simulation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>For hardware setup instructions see <a href="../flashing_preparation/">Flashing
preparation</a>.</p>
<p>Building and flashing is performed by executing (from <code>fobnail</code> directory):</p>
<div class="highlight"><pre><span></span><code>env<span class="w"> </span><span class="nv">FOBNAIL_PO_ROOT</span><span class="o">=</span>root_ca.crt<span class="w"> </span><span class="nv">FOBNAIL_EK_ROOT_DIR</span><span class="o">=</span>tpm_ek_roots<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>./build.sh<span class="w"> </span>-t<span class="w"> </span>nrf<span class="w"> </span>--run
</code></pre></div>
<p>A console with Fobnail Token output will be displayed. It is not required
for normal operation but can be useful for debugging. It can be closed with
Ctrl-C at any point. After that, Token can be used without nRF52840-DK -
just plug it wherever it's needed.</p>
</div>
<div class="tabbed-block">
<p>Make sure you have the network set up properly. See <a href="../networking_setup/">Networking
setup</a> for instructions. For firmware to work properly
you need the <code>fobnail0</code> network interface configured.</p>
<p>To build and run firmware execute the following commands (from <code>fobnail</code>
directory).</p>
<div class="highlight"><pre><span></span><code>env<span class="w"> </span><span class="nv">FOBNAIL_LOG</span><span class="o">=</span>info<span class="w"> </span><span class="nv">FOBNAIL_PO_ROOT</span><span class="o">=</span>root_ca.crt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">FOBNAIL_EK_ROOT_DIR</span><span class="o">=</span>tpm_ek_roots<span class="w"> </span>./build.sh<span class="w"> </span>-t<span class="w"> </span>pc<span class="w"> </span>--run
</code></pre></div>
<p><code>FOBNAIL_LOG</code> environment variable sets log level. The possible log levels
are: <code>error</code>, <code>warning</code>, <code>info</code>, <code>debug</code>, <code>trace</code>. This variable is valid
only for PC target.</p>
<p>Another variable used only on PC is <code>FOBNAIL_DEVICE_ID</code> - on hardware we
used FICR registers to create a device ID, this gives a way of configuring
it for emulation. This variable is optional, without it an ID of 0 is used.</p>
<p><code>build.sh</code> automatically starts Token emulation. It runs until it's
terminated with Ctrl-C.</p>
</div>
</div>
</div>
<hr />
<h2 id="pc-applications">PC applications</h2>
<p>Platform Owner and Attester have similar set of prerequisites, listed below.
Depending on use case, they may or may not be run on the same PC, so these steps
may have to be repeated on different computers.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span>make<span class="w"> </span>gcc<span class="w"> </span>autoconf<span class="w"> </span>automake<span class="w"> </span>pkg-config<span class="w"> </span>libtool<span class="w"> </span>libssl-dev
</code></pre></div>
<p>Both applications use <a href="https://github.com/obgm/libcoap/tree/release-4.3.0">libcoap with v3 API</a>
which isn't provided by main Linux distributions yet, so it has to be built from
sources and installed:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/obgm/libcoap.git<span class="w"> </span>--recurse-submodules
<span class="nb">cd</span><span class="w"> </span>libcoap
git<span class="w"> </span>checkout<span class="w"> </span>release-4.3.0
./autogen.sh<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
./configure<span class="w"> </span>--exec-prefix<span class="o">=</span>/usr<span class="w"> </span>--disable-tests<span class="w"> </span>--disable-documentation<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--disable-manpages<span class="w"> </span>--enable-dtls<span class="w"> </span>--with-tinydtls<span class="w"> </span>--enable-fast-install<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
make<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>make<span class="w"> </span>install
</code></pre></div>
<h4 id="platform-owner">Platform Owner</h4>
<p>With prerequisites installed, building Platform Owner application is simple -
just clone and build:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/fobnail/fobnail-platform-owner<span class="w"> </span>--recurse-submodules
<span class="nb">cd</span><span class="w"> </span>fobnail-platform-owner
make
</code></pre></div>
<p>Produced binary is located in <code>bin/fobnail-platform-owner</code>, from where it can be
moved to <code>PATH</code> or just started from there.</p>
<h4 id="attester">Attester</h4>
<p>Attester requires additional packages to talk with TPM and download TPM's
certificate chain from Internet:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>libtss2-dev<span class="w"> </span>libcurl4-openssl-dev
</code></pre></div>
<p>After that, building is simple:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/fobnail/fobnail-attester<span class="w"> </span>--recurse-submodules
<span class="nb">cd</span><span class="w"> </span>fobnail-attester
make
</code></pre></div>
<p>Two executables are produced in <code>bin</code> folder: <code>fobnail-attester</code> and
<code>fobnail-attester-with-provisioning</code>. First one can be moved to <code>PATH</code> for
easier use. The latter is expected to be run only once per Token, by an
administrator in a controlled environment, and not for daily use, so it can be
not installed to avoid confusion.</p>
<h2 id="summary-and-next-steps">Summary and next steps</h2>
<p>Congratulations, you have built all of the components of Fobnail! From here you
should proceed to <a href="/token_provisioning">Token provisioning guide</a>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  </body>
</html>